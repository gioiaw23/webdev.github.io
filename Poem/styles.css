:root{
  --bg0:#060709;
  --bg1:#0b0c10;
  --ink: rgba(245,245,245,0.92);
  --inkDim: rgba(245,245,245,0.70);
  --inkFaint: rgba(245,245,245,0.25);
  --stroke: rgba(245,245,245,0.85);
  --shadow: rgba(0,0,0,0.75);


  /* interaction amplitudes */
  --tension: 0;       /* line 1 stretch field */
}

*{ box-sizing: border-box; }
html,body{ height:100%; }
body{
  margin:0;
  overflow-x:hidden;
  background: var(--bg0);
  color: var(--ink);
  font-family: "Cormorant Garamond", serif;
}

/* --- Background: “cloth” using only CSS gradients (no images) --- */
.stage{
min-height: 240vh;   
position: relative;
display:block;
padding: 5.5vh 5vw;
background:
  radial-gradient(1200px 700px at 25% 10%, rgba(255,255,255,0.10), transparent 55%),
  radial-gradient(900px 600px at 65% 35%, rgba(255,255,255,0.07), transparent 60%),
  radial-gradient(1000px 700px at 40% 80%, rgba(255,255,255,0.06), transparent 60%),
  radial-gradient(800px 500px at 85% 75%, rgba(255,255,255,0.05), transparent 60%),
  linear-gradient(145deg, #0a0b0f, #05060a 45%, #07080c);
transition: filter 900ms ease;
}
.stage::before{
  content:"";
  position:absolute; inset:-10%;
  background:
    radial-gradient(700px 400px at 20% 50%, rgba(0,0,0,0.65), transparent 70%),
    radial-gradient(900px 500px at 75% 55%, rgba(0,0,0,0.60), transparent 72%),
    radial-gradient(600px 400px at 55% 95%, rgba(0,0,0,0.65), transparent 75%);
  filter: blur(22px);
  opacity: 0.9;
  pointer-events:none;
  transition: opacity 900ms ease;
}
.stage::after{
  content:"";
  position:absolute; inset:0;
  background:
    linear-gradient(0deg, rgba(0,0,0,0.55), rgba(0,0,0,0.15) 45%, rgba(0,0,0,0.50));
  pointer-events:none;
  transition: opacity 900ms ease;
}


.stage .colorWash{ display:none; }
.stage::marker{ content:""; } 
.stage::selection{ background: transparent; } 

.stage.colorMode::after{
opacity: 0.35;
}

.stage.colorMode{
--colorOn: 1;
filter: saturate(1.15);
}

.stage{
--colorOn: 0;
background:
  /* colorful blooms (fade in by alpha using --colorOn) */
  radial-gradient(520px 360px at 12% 16%, hsla(300, 75%, 60%, calc(0.16 * var(--colorOn))), transparent 62%),
  radial-gradient(640px 420px at 26% 38%, hsla(210, 85%, 58%, calc(0.14 * var(--colorOn))), transparent 66%),
  radial-gradient(520px 420px at 18% 72%, hsla(160, 70%, 55%, calc(0.12 * var(--colorOn))), transparent 68%),

  radial-gradient(560px 420px at 52% 18%, hsla(40, 95%, 58%,  calc(0.12 * var(--colorOn))), transparent 66%),
  radial-gradient(740px 520px at 68% 34%, hsla(190, 85%, 55%, calc(0.13 * var(--colorOn))), transparent 64%),
  radial-gradient(520px 380px at 82% 18%, hsla(330, 75%, 60%, calc(0.14 * var(--colorOn))), transparent 66%),

  radial-gradient(620px 520px at 78% 62%, hsla(255, 80%, 62%, calc(0.13 * var(--colorOn))), transparent 68%),
  radial-gradient(520px 420px at 60% 78%, hsla(120, 70%, 55%, calc(0.10 * var(--colorOn))), transparent 70%),
  radial-gradient(760px 560px at 46% 88%, hsla(55,  95%, 58%,  calc(0.10 * var(--colorOn))), transparent 70%),

  /* a few tiny “spark” spots */
  radial-gradient(260px 220px at 34% 56%, hsla(285, 85%, 64%, calc(0.10 * var(--colorOn))), transparent 68%),
  radial-gradient(240px 200px at 90% 48%, hsla(205, 90%, 62%, calc(0.10 * var(--colorOn))), transparent 70%),
  radial-gradient(260px 220px at 08% 48%, hsla(20,  95%, 60%, calc(0.08 * var(--colorOn))), transparent 72%),

  /* your original cloth layers */
  radial-gradient(1200px 700px at 25% 10%, rgba(255,255,255,0.10), transparent 55%),
  radial-gradient(900px 600px at 65% 35%, rgba(255,255,255,0.07), transparent 60%),
  radial-gradient(1000px 700px at 40% 80%, rgba(255,255,255,0.06), transparent 60%),
  radial-gradient(800px 500px at 85% 75%, rgba(255,255,255,0.05), transparent 60%),
  linear-gradient(145deg, #0a0b0f, #05060a 45%, #07080c);

transition: background 900ms ease;
}


/* --- Content layout --- */
.content{
position: sticky;
top: 0;
z-index: 1;
min-height: 100vh;
}

.meta{
  position:absolute;
  top:0;
  left:0;
  font-size: clamp(18px, 1.55vw, 28px);
  line-height: 1.35;
  color: var(--inkDim);
  letter-spacing: 0.01em;
  text-shadow: 0 12px 40px var(--shadow);
  user-select:none;
}
.meta .title{
  color: var(--ink);
  font-weight: 600;
  letter-spacing: 0.02em;
}
.meta .by{ margin-top: 8px; font-style: italic; }

.line{
  position:absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align:center;
  width: min(70vw, 980px);
  text-shadow: 0 18px 60px var(--shadow);
  user-select:none;
}

.line1{ top: 26vh; font-size: clamp(22px, 2.2vw, 38px); }
.line2{ top: 37vh; font-size: clamp(22px, 2.1vw, 36px); }
.line3{
  top: 68vh;
  left: 66%;
  width: min(62vw, 980px);
  text-align:left;
  font-size: clamp(22px, 2.2vw, 38px);
}

.line{
/* keep your existing transform: translateX(-50%); */
--slideX: 0%;
translate: var(--slideX) 0;     /* does NOT overwrite transform */
opacity: 1;
transition:
  translate 900ms cubic-bezier(.2,.9,.2,1),
  opacity 650ms ease;
}

/* start with line2 and line3 off-screen to the right */
.line2, .line3{
--slideX: 120%;
opacity: 0;
}

/* Step 0 (default): line1 visible, others right/off */
#stage[data-step="0"] .line1{ --slideX: 0%; opacity: 1; }
#stage[data-step="0"] .line2{ --slideX: 120%; opacity: 0; }
#stage[data-step="0"] .line3{ --slideX: 120%; opacity: 0; }

/* Step 1: line1 exits left, line2 enters from right */
#stage[data-step="1"] .line1{ --slideX: -120%; opacity: 0; }
#stage[data-step="1"] .line2{ --slideX: 0%; opacity: 1; }
#stage[data-step="1"] .line3{ --slideX: 120%; opacity: 0; }

/* Step 2: line2 exits left, line3 enters from right */
#stage[data-step="2"] .line1{ --slideX: -120%; opacity: 0; }
#stage[data-step="2"] .line2{ --slideX: -120%; opacity: 0; }
#stage[data-step="2"] .line3{ --slideX: 0%; opacity: 1; }

/* word styling */
.w{
  display:inline-block;
  position:relative;
  padding: 0 0.06em;
  transition: transform 450ms ease, color 450ms ease, opacity 450ms ease, letter-spacing 450ms ease;
  will-change: transform, color;
}
.sp{ display:inline-block; width: 0.34em; }

/* “passed through”: hollow + afterimage */
.w.hollow{
  color: transparent;
  -webkit-text-stroke: 1px var(--stroke);
  /* text-stroke: 1px var(--stroke); */
  transform: translateX(10px);
}
.afterimage{
  position:absolute;
  left:0; top:0;
  color: rgba(255,255,255,0.15);
  filter: blur(0.2px);
  transform: translateX(-10px);
  pointer-events:none;
  opacity: 0;
}
.w.ghost .afterimage{
  opacity: 1;
  animation: fadeGhost 650ms ease forwards;
}
@keyframes fadeGhost{
  0%{ opacity: 0; transform: translateX(-12px); }
  25%{ opacity: 1; }
  100%{ opacity: 0; transform: translateX(-28px); }
}

/* needle styling */
.needleWrap{
  display:inline-flex;
  align-items: baseline;
  gap: 0.12em;
}
.needle{
  font-family: "Petit Formal Script", cursive;
  font-size: 1.22em;
  color: var(--ink);
  position: relative;
  padding: 0 0.14em 0.05em 0.14em;
  cursor: pointer;
  transition: transform 500ms ease, color 500ms ease, opacity 500ms ease;
}

/* thread draggable */
.thread{
  cursor: grab;
  position: relative;
  font-style: italic;
}
.thread.dragging{
  cursor: grabbing;
  z-index: 5;
  /* IMPORTANT: use translate() instead of transform so it can coexist better */
  translate: var(--dx) var(--dy);
  filter: drop-shadow(0 18px 30px rgba(0,0,0,0.65));
}  
.thread.dragging.hollow{
  /* while dragging, don't apply the hover slide */
  transform: none !important;
}
.thread.locked{
  color: rgba(245,245,245,0.92);
  transition: color 700ms ease;
}
.thread.locked::after{
  content:"—";
  position:absolute;
  left: 100%;
  top: 37%;
  transform: translateY(-50%);
  color: rgba(255,255,255,0.22);
}
/* thread tail that appears after threading */
.thread .tail{
  display:inline-block;
  margin-left: 0.10em;
  transform: translateY(-0.06em);
  letter-spacing: 0.06em;
  color: rgba(255,255,255,0.22);
  opacity: 0;
  max-width: 0ch;
  overflow: hidden;
  white-space: nowrap;
}

.thread.locked .tail{
  opacity: 1;
  animation: tailGrow 900ms cubic-bezier(.2,.9,.2,1) forwards;
}

@keyframes tailGrow{
  from{ max-width: 0ch; }
  to{ max-width: 22ch; } /* controls how long it becomes */
}


/* puncture dot */
.puncture{
  position:absolute;
  width: 10px; height:10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.75);
  box-shadow: 0 0 18px rgba(255,255,255,0.25);
  transform: translate(-50%,-50%);
  opacity: 0;
  animation: pop 720ms ease forwards;
  pointer-events:none;
}
@keyframes pop{
  0%{ opacity:0; transform: translate(-50%,-50%) scale(0.6); }
  25%{ opacity:1; transform: translate(-50%,-50%) scale(1); }
  100%{ opacity:0; transform: translate(-50%,-50%) scale(1.8); }
}

/* line1 tension field */
.line1.tension .w{
  letter-spacing: calc(var(--tension) * 0.03em);
  transform: translateY(calc(var(--tension) * -1px));
}

.w[data-special="everything"]{
font-style: italic;
}

.w[data-special="color"]{
font-style: italic;
letter-spacing: 0.02em;
}


/* --- “Everything” ghost burst overlay --- */
.ghostBurst{
position: fixed;
inset: 0;
pointer-events: none;
z-index: 4;              /* above chorus (0) and content (1), below hint (5) */
}

.ghostWord{
position: absolute;
left: 0; top: 0;
font-family: "Petit Formal Script", cursive;  /* or inherit */
font-size: clamp(18px, 2.2vw, 34px);
color: rgba(255,255,255,0.35);
letter-spacing: 0.02em;
white-space: nowrap;
filter: blur(0.2px);
text-shadow: 0 10px 40px rgba(0,0,0,0.55);
will-change: transform, opacity;
}


/* line3 “stitched” underline (typographic) */
.stitched{
  position:relative;
}
.stitched::after{
  content:"x x x x x x x x x x x x";
  position:absolute;
  left:0;
  right:0;
  top: 1.1em;
  font-size: 0.55em;
  letter-spacing: 0.22em;
  color: rgba(255,255,255,0.22);
  opacity: 0;
  transform: translateY(-2px);
  white-space: nowrap;
  overflow:hidden;
  pointer-events:none;
}
.stitched.active::after{
  opacity: 1;
  animation: sew 900ms linear infinite;
}
@keyframes sew{
  0%{ transform: translateY(-2px) translateX(0); }
  100%{ transform: translateY(-2px) translateX(-1.2em); }
}

/* line3 stitching connectors */
.connector{
  display:inline-block;
  color: rgba(255,255,255,0.25);
  margin: 0 0.08em;
  transform: translateY(-0.06em);
  opacity: 0;
  animation: connIn 520ms ease forwards;
  pointer-events: none;
}
@keyframes connIn{
  to{ opacity:1; }
}

/* tint spread */
.tinted{
  color: rgba(245,245,245,0.88);
  transition: color 650ms ease;
}
.tinted.on{
  color: var(--tintA);
  text-shadow: 0 10px 45px rgba(0,0,0,0.7);
}
.tinted.faint{
  color: rgba(245,245,245,0.88);
  text-shadow: 0 10px 45px rgba(0,0,0,0.7);
}


/* small helper */
.hint{
  position: fixed;
  right: 18px;
  bottom: 14px;
  font-size: 14px;
  color: rgba(255,255,255,0.30);
  z-index: 5;
  user-select:none;
  text-shadow: 0 10px 30px rgba(0,0,0,0.8);
  letter-spacing: 0.02em;
}